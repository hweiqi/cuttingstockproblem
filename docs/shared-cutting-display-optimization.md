# 共刀顯示資訊優化文檔

## 修改摘要

本次修改解決了系統中共刀節省資訊重複顯示的問題，優化了使用者介面的資訊呈現方式。

## 問題分析

### 原始問題
在 `CuttingResult` 組件中，共刀節省資訊被重複顯示在兩個位置：

1. **零件資訊區域**（已有正確顯示）
   ```tsx
   {(part as any).angleSavings && (
     <div className="savings">節省: {(part as any).angleSavings.toFixed(2)} mm</div>
   )}
   ```

2. **切割損耗區域**（重複且不準確）
   ```tsx
   {part.isSharedCut ? (
     <>
       <div className="shared-cut-saving">
         共刀節省: 0 mm  // 硬編碼的0，不正確
       </div>
       <div className="actual-loss">
         實際損耗: {cuttingLoss} mm  // 共刀時不應有損耗
       </div>
     </>
   ) : (
     <>切割損耗: {cuttingLoss} mm</>
   )}
   ```

### 問題影響
- **資訊重複**：同樣的節省資訊顯示兩次
- **資訊不準確**：共刀節省顯示為固定的0mm
- **邏輯錯誤**：共刀連接處顯示"實際損耗"，但實際上共刀時沒有切割損耗

## 解決方案

### 設計原則
1. **避免重複**：每個資訊只在最合適的位置顯示一次
2. **準確性**：確保顯示的資訊與實際情況相符
3. **清晰性**：讓使用者容易理解各種狀態

### 具體修改

#### 1. 修改切割損耗區域的顯示邏輯
```tsx
{partIndex < (plan.cuts || plan.parts).length - 1 && (
  <div className="cutting-loss">
    {part.isSharedCut ? (
      <div className="shared-cut-indicator">
        共刀連接
      </div>
    ) : (
      <>切割損耗: {cuttingLoss} mm</>
    )}
  </div>
)}
```

#### 2. 更新樣式
```css
.shared-cut-indicator {
  color: #2196f3;
  font-weight: bold;
  font-style: italic;
}
```

### 修改後的顯示邏輯

| 零件類型 | 零件資訊區域 | 連接處顯示 |
|---------|------------|-----------|
| 一般零件 | 零件ID、長度、角度 | 切割損耗: X mm |
| 共刀零件 | 零件ID、長度、角度、**節省: Y mm** | **共刀連接** |

## 技術細節

### 資料流程
1. 共刀節省資訊從 `angleSavings` 屬性獲取
2. 零件資訊區域負責顯示詳細的節省數值
3. 連接處只顯示連接類型，不重複顯示數值

### 相關檔案
- `/src/components/CuttingResult.tsx` - 主要修改檔案
- 第145-147行：零件資訊中的節省顯示（保持不變）
- 第178-188行：切割損耗區域（已修改）
- 第373-377行：CSS樣式（已更新）

## 測試驗證

### 功能測試
1. **共刀功能正常**：測試顯示共刀節省功能仍然正常運作
2. **資訊不重複**：每個共刀零件的節省資訊只顯示一次
3. **顯示準確**：節省數值正確（例如：45度角節省約28.28mm）

### 測試結果
```
共刀功能測試結果：
- 共刀鏈數：2
- 總節省：226.27mm
- 共刀配對數：10
- 實際共刀零件數：10
```

## 優點

1. **更清晰的資訊架構**：避免使用者困惑
2. **更準確的資訊**：移除錯誤的硬編碼值
3. **更好的可維護性**：簡化了顯示邏輯
4. **保持功能完整**：共刀功能完全不受影響

## 注意事項

- 本次修改僅涉及顯示層面，不影響共刀計算邏輯
- 共刀節省的實際計算仍在 `DynamicChainBuilder` 和相關類中進行
- 如需修改節省值的計算方式，應修改核心計算邏輯而非顯示組件

## 結論

通過移除重複的共刀節省資訊顯示，系統的使用者介面變得更加清晰和準確。這個修改遵循了"單一資訊來源"的原則，提升了系統的整體品質。