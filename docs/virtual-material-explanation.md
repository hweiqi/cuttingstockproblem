# 虛擬材料（Virtual Material）詳細說明

## 1. 什麼是虛擬材料？

虛擬材料是系統在實際材料不足以容納所有零件時，自動創建的臨時材料。這些材料並非實際存在，而是系統為了確保所有零件都能被排版而產生的計算輔助工具。

## 2. 為什麼需要虛擬材料？

### 2.1 保證100%排版
在實際生產中，可能遇到以下情況：
- 提供的材料總長度不足
- 材料規格與零件需求不匹配
- 切割損耗導致實際可用長度減少

虛擬材料機制確保即使在材料不足的情況下，系統仍能提供完整的排版方案。

### 2.2 問題識別
虛擬材料的產生實際上是一個警告信號，提示使用者：
- 需要採購額外材料
- 需要調整零件設計
- 需要重新規劃生產計劃

## 3. 虛擬材料如何產生？

### 3.1 觸發條件
當系統在排版過程中發現某個零件無法放置到任何現有材料時，會觸發虛擬材料創建流程。

### 3.2 產生流程

```typescript
// 虛擬材料創建邏輯
1. 檢測到零件無法放置
2. 計算所需最小長度 = 零件長度 + 前端損耗 + 後端損耗 + 緩衝空間
3. 從標準材料長度中選擇最接近的規格
4. 創建虛擬材料實例
5. 將零件放置到虛擬材料上
```

### 3.3 標準長度選擇
虛擬材料使用標準材料長度（6000, 9000, 10000, 12000, 15000mm），選擇原則：
- 選擇能容納零件的最小標準長度
- 如果零件超過最大標準長度，選擇最大標準長度（15000mm）

## 4. 虛擬材料的特徵

### 4.1 識別標記
- ID 格式：`VIRTUAL_${序號}`（例如：VIRTUAL_0, VIRTUAL_1）
- 屬性標記：`isVirtual: true`
- 數量固定：每個虛擬材料數量為 1

### 4.2 在系統中的表現
```typescript
interface VirtualMaterial {
  id: string;          // VIRTUAL_開頭的唯一識別碼
  length: number;      // 標準材料長度之一
  quantity: 1;         // 固定為 1
  isVirtual: true;     // 虛擬材料標記
}
```

## 5. 虛擬材料的影響

### 5.1 對排版結果的影響
- **正面**：確保所有零件都有排版方案
- **負面**：增加額外的材料需求和成本

### 5.2 對生產的影響
使用虛擬材料意味著：
1. 需要採購對應規格的實際材料
2. 可能需要調整生產計劃
3. 增加材料成本

### 5.3 對效率計算的影響
- 虛擬材料納入總材料長度計算
- 可能降低整體材料利用率
- 在報告中會特別標註虛擬材料數量

## 6. 如何減少虛擬材料的產生？

### 6.1 材料規劃
- 提供充足的材料庫存
- 選擇多樣化的材料規格
- 根據零件需求預先規劃材料

### 6.2 零件設計優化
- 避免設計過長的零件
- 考慮將長零件分割
- 統一零件規格以提高通用性

### 6.3 排版策略優化
- 使用優化的排版算法
- 合理設定切割損耗參數
- 批量處理相似零件

## 7. 虛擬材料的實際應用建議

### 7.1 預警機制
將虛擬材料的產生作為預警信號：
- 虛擬材料數 > 0：檢查材料庫存
- 虛擬材料數 > 總材料數的 10%：重新評估生產計劃

### 7.2 成本評估
每產生一個虛擬材料，意味著：
- 額外的材料採購成本
- 可能的生產延遲
- 庫存管理壓力

### 7.3 決策支援
根據虛擬材料情況做出決策：
- 少量虛擬材料：直接採購補充
- 大量虛擬材料：考慮調整設計或分批生產

## 8. 系統提示與警告

當系統產生虛擬材料時，會提供以下資訊：

### 8.1 警告訊息
```
警告：已創建 X 個虛擬材料以確保所有零件都能被排版
```

### 8.2 詳細報告
- 虛擬材料清單（ID、長度、用途）
- 使用虛擬材料的零件明細
- 建議的實際材料採購清單

## 9. 最佳實踐

### 9.1 預防措施
1. 定期檢查材料庫存與零件需求的匹配度
2. 使用歷史數據預測材料需求
3. 建立材料安全庫存

### 9.2 應對策略
1. 將虛擬材料需求納入採購計劃
2. 評估是否可以調整零件設計
3. 考慮與供應商建立快速補貨機制

### 9.3 持續改進
1. 分析虛擬材料產生的模式
2. 優化材料規格配置
3. 改進排版算法以減少浪費

## 10. 總結

虛擬材料是一個重要的系統功能，它：
- 保證了排版的完整性
- 提供了材料不足的預警
- 支援更好的生產決策

正確理解和使用虛擬材料機制，可以幫助企業更好地管理生產資源，提高整體效率。